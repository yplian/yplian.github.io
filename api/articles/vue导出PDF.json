{"title":"vue导出PDF","slug":"vue导出PDF","date":"2019-01-12T16:00:00.000Z","updated":"2019-01-12T16:00:00.000Z","comments":true,"path":"api/articles/vue导出PDF.json","excerpt":"新需求需要导出当前页面为PDF，通过Google找到了前端就可实现的一种导出方式。<br>","covers":null,"content":"<p>新需求需要导出当前页面为PDF，通过Google找到了前端就可实现的一种导出方式。<br><a id=\"more\"></a></p>\n<h2 id=\"依赖\"><a href=\"#依赖\" class=\"headerlink\" title=\"依赖\"></a>依赖</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 第一个将页面html转换成图片</span></span><br><span class=\"line\">npm install html2canvas --save</span><br><span class=\"line\"><span class=\"comment\">// 第二个将图片生成pdf</span></span><br><span class=\"line\">npm install jspdf --save</span><br></pre></td></tr></table></figure>\n<h2 id=\"封装组件\"><a href=\"#封装组件\" class=\"headerlink\" title=\"封装组件\"></a>封装组件</h2><p>创建<code>htmlToPdf.js</code>,看个人习惯，本例放在<code>src/utils/htmlToPdf.js</code>,将其注册为插件。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 导出页面为PDF格式</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> Vue <span class=\"keyword\">from</span> <span class=\"string\">'vue'</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> html2Canvas <span class=\"keyword\">from</span> <span class=\"string\">'html2canvas'</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> JsPDF <span class=\"keyword\">from</span> <span class=\"string\">'jspdf'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">  执行方式  参数 (导出的容器id,导出pdf文件名 )</span></span><br><span class=\"line\"><span class=\"comment\">  &lt;button @click=\"getPdf('#pdfDom','test')\"&gt;导出&lt;/button&gt;</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> htmlToPdf = &#123;</span><br><span class=\"line\">  install (Vue, options) &#123;</span><br><span class=\"line\">    Vue.prototype.getPdf = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">id,pdfTitle</span>) </span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">var</span> title = pdfTitle</span><br><span class=\"line\">      html2Canvas(<span class=\"built_in\">document</span>.querySelector(id), &#123;</span><br><span class=\"line\">        allowTaint: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        logging: <span class=\"literal\">false</span></span><br><span class=\"line\">      &#125;).then(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">canvas</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> contentWidth = canvas.width</span><br><span class=\"line\">        <span class=\"keyword\">let</span> contentHeight = canvas.height</span><br><span class=\"line\">        <span class=\"keyword\">let</span> pageHeight = contentWidth / <span class=\"number\">592.28</span> * <span class=\"number\">841.89</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> leftHeight = contentHeight</span><br><span class=\"line\">        <span class=\"keyword\">let</span> position = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> imgWidth = <span class=\"number\">595.28</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> imgHeight = <span class=\"number\">592.28</span> / contentWidth * contentHeight</span><br><span class=\"line\">        <span class=\"keyword\">let</span> pageData = canvas.toDataURL(<span class=\"string\">'image/jpeg'</span>, <span class=\"number\">1.0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">let</span> PDF = <span class=\"keyword\">new</span> JsPDF(<span class=\"string\">''</span>, <span class=\"string\">'pt'</span>, <span class=\"string\">'a4'</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (leftHeight &lt; pageHeight) &#123;</span><br><span class=\"line\">          PDF.addImage(pageData, <span class=\"string\">'JPEG'</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, imgWidth, imgHeight)</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">while</span> (leftHeight &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            PDF.addImage(pageData, <span class=\"string\">'JPEG'</span>, <span class=\"number\">0</span>, position, imgWidth, imgHeight)</span><br><span class=\"line\">            leftHeight -= pageHeight</span><br><span class=\"line\">            position -= <span class=\"number\">841.89</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (leftHeight &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">              PDF.addPage()</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        PDF.save(title + <span class=\"string\">'.pdf'</span>)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Vue.use(htmlToPdf)</span><br></pre></td></tr></table></figure>\n<h2 id=\"引用\"><a href=\"#引用\" class=\"headerlink\" title=\"引用\"></a>引用</h2><p>在当前项目入口文件，本例为当前<code>vue-cli3</code>入口文件为<code>main.js</code>引入,<code>@</code>指的当前src目录，通过<code>webpack</code>可自定义其它快捷。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">'@/utils/htmlToPdf'</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"使用方式\"><a href=\"#使用方式\" class=\"headerlink\" title=\"使用方式\"></a>使用方式</h2><h3 id=\"html使用\"><a href=\"#html使用\" class=\"headerlink\" title=\"html使用\"></a>html使用</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--  参数 (导出的容器id,导出pdf文件名 ) --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">\"getPdf('#pdfDom','test')\"</span>&gt;</span>导出<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"js使用\"><a href=\"#js使用\" class=\"headerlink\" title=\"js使用\"></a>js使用</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">this</span>.getPdf(<span class=\"string\">'#pdfDom'</span>,<span class=\"string\">'test'</span>)</span><br></pre></td></tr></table></figure>\n","more":"</p>\n<h2 id=\"依赖\"><a href=\"#依赖\" class=\"headerlink\" title=\"依赖\"></a>依赖</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 第一个将页面html转换成图片</span></span><br><span class=\"line\">npm install html2canvas --save</span><br><span class=\"line\"><span class=\"comment\">// 第二个将图片生成pdf</span></span><br><span class=\"line\">npm install jspdf --save</span><br></pre></td></tr></table></figure>\n<h2 id=\"封装组件\"><a href=\"#封装组件\" class=\"headerlink\" title=\"封装组件\"></a>封装组件</h2><p>创建<code>htmlToPdf.js</code>,看个人习惯，本例放在<code>src/utils/htmlToPdf.js</code>,将其注册为插件。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 导出页面为PDF格式</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> Vue <span class=\"keyword\">from</span> <span class=\"string\">'vue'</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> html2Canvas <span class=\"keyword\">from</span> <span class=\"string\">'html2canvas'</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> JsPDF <span class=\"keyword\">from</span> <span class=\"string\">'jspdf'</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">  执行方式  参数 (导出的容器id,导出pdf文件名 )</span></span><br><span class=\"line\"><span class=\"comment\">  &lt;button @click=\"getPdf('#pdfDom','test')\"&gt;导出&lt;/button&gt;</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> htmlToPdf = &#123;</span><br><span class=\"line\">  install (Vue, options) &#123;</span><br><span class=\"line\">    Vue.prototype.getPdf = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">id,pdfTitle</span>) </span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">var</span> title = pdfTitle</span><br><span class=\"line\">      html2Canvas(<span class=\"built_in\">document</span>.querySelector(id), &#123;</span><br><span class=\"line\">        allowTaint: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        logging: <span class=\"literal\">false</span></span><br><span class=\"line\">      &#125;).then(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">canvas</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> contentWidth = canvas.width</span><br><span class=\"line\">        <span class=\"keyword\">let</span> contentHeight = canvas.height</span><br><span class=\"line\">        <span class=\"keyword\">let</span> pageHeight = contentWidth / <span class=\"number\">592.28</span> * <span class=\"number\">841.89</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> leftHeight = contentHeight</span><br><span class=\"line\">        <span class=\"keyword\">let</span> position = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> imgWidth = <span class=\"number\">595.28</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> imgHeight = <span class=\"number\">592.28</span> / contentWidth * contentHeight</span><br><span class=\"line\">        <span class=\"keyword\">let</span> pageData = canvas.toDataURL(<span class=\"string\">'image/jpeg'</span>, <span class=\"number\">1.0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">let</span> PDF = <span class=\"keyword\">new</span> JsPDF(<span class=\"string\">''</span>, <span class=\"string\">'pt'</span>, <span class=\"string\">'a4'</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (leftHeight &lt; pageHeight) &#123;</span><br><span class=\"line\">          PDF.addImage(pageData, <span class=\"string\">'JPEG'</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, imgWidth, imgHeight)</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">while</span> (leftHeight &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            PDF.addImage(pageData, <span class=\"string\">'JPEG'</span>, <span class=\"number\">0</span>, position, imgWidth, imgHeight)</span><br><span class=\"line\">            leftHeight -= pageHeight</span><br><span class=\"line\">            position -= <span class=\"number\">841.89</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (leftHeight &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">              PDF.addPage()</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        PDF.save(title + <span class=\"string\">'.pdf'</span>)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Vue.use(htmlToPdf)</span><br></pre></td></tr></table></figure>\n<h2 id=\"引用\"><a href=\"#引用\" class=\"headerlink\" title=\"引用\"></a>引用</h2><p>在当前项目入口文件，本例为当前<code>vue-cli3</code>入口文件为<code>main.js</code>引入,<code>@</code>指的当前src目录，通过<code>webpack</code>可自定义其它快捷。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">'@/utils/htmlToPdf'</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"使用方式\"><a href=\"#使用方式\" class=\"headerlink\" title=\"使用方式\"></a>使用方式</h2><h3 id=\"html使用\"><a href=\"#html使用\" class=\"headerlink\" title=\"html使用\"></a>html使用</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--  参数 (导出的容器id,导出pdf文件名 ) --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">\"getPdf('#pdfDom','test')\"</span>&gt;</span>导出<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"js使用\"><a href=\"#js使用\" class=\"headerlink\" title=\"js使用\"></a>js使用</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">this</span>.getPdf(<span class=\"string\">'#pdfDom'</span>,<span class=\"string\">'test'</span>)</span><br></pre></td></tr></table></figure>","categories":[{"name":"js","path":"api/categories/js.json"}],"tags":[{"name":"vue","path":"api/tags/vue.json"},{"name":"pdf","path":"api/tags/pdf.json"}]}