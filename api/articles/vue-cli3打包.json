{"title":"vue-cli3打包","slug":"vue-cli3打包","date":"2018-11-20T16:00:00.000Z","updated":"2018-11-20T16:00:00.000Z","comments":true,"path":"api/articles/vue-cli3打包.json","excerpt":"最近通过vue-cli3配置项目的时候，对于引入的ElementUI或者测试使用的jQuery等第三方包，存在打包之后，app.js文件过大的问题。解决的方案目前看来存在两种方式。<br>","covers":null,"content":"<p>最近通过vue-cli3配置项目的时候，对于引入的ElementUI或者测试使用的jQuery等第三方包，存在打包之后，app.js文件过大的问题。解决的方案目前看来存在两种方式。<br><a id=\"more\"></a></p>\n<p>在vue-cli3不存在暴露的接口文件，需要通过<code>vue.config.js</code>配置来使用,展示的均为vue-cli3。vue-cli2类似，区别在于可在暴露的配置文件中直接添加。</p>\n<h2 id=\"webpack-bundle-analyzer\"><a href=\"#webpack-bundle-analyzer\" class=\"headerlink\" title=\"webpack-bundle-analyzer\"></a>webpack-bundle-analyzer</h2><p>用于显示打包之后的文件分析其大小.</p>\n<p>安装<code>npm install –save-dev webpack-bundle-analyzer</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// vue.config.js文件</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> BundleAnalyzerPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">'webpack-bundle-analyzer'</span>).BundleAnalyzerPlugin;</span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"comment\">// configureWebpack返回一个对象，会被 webpack-merge合并最终配置</span></span><br><span class=\"line\">    configureWebpack: <span class=\"function\"><span class=\"params\">config</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (process.env.NODE_ENV === <span class=\"string\">'production'</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 为生产环境修改配置...</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">                plugins: [</span><br><span class=\"line\">                    <span class=\"keyword\">new</span> BundleAnalyzerPlugin(</span><br><span class=\"line\">                        <span class=\"comment\">//  可以是`server`，`static`或`disabled`。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  在`server`模式下，分析器将启动HTTP服务器来显示软件包报告。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  在“静态”模式下，会生成带有报告的单个HTML文件。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  在`disabled`模式下，你可以使用这个插件来将`generateStatsFile`设置为`true`来生成Webpack Stats JSON文件。</span></span><br><span class=\"line\">                        analyzerMode: <span class=\"string\">'server'</span>,</span><br><span class=\"line\">                        <span class=\"comment\">//  将在“服务器”模式下使用的主机启动HTTP服务器。</span></span><br><span class=\"line\">                        analyzerHost: <span class=\"string\">'127.0.0.1'</span>,</span><br><span class=\"line\">                        <span class=\"comment\">//  将在“服务器”模式下使用的端口启动HTTP服务器。</span></span><br><span class=\"line\">                        analyzerPort: <span class=\"number\">8888</span>,</span><br><span class=\"line\">                        <span class=\"comment\">//  路径捆绑，将在`static`模式下生成的报告文件。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  相对于捆绑输出目录。</span></span><br><span class=\"line\">                        reportFilename: <span class=\"string\">'report.html'</span>,</span><br><span class=\"line\">                        <span class=\"comment\">//  模块大小默认显示在报告中。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  应该是`stat`，`parsed`或者`gzip`中的一个。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  有关更多信息，请参见“定义”一节。</span></span><br><span class=\"line\">                        defaultSizes: <span class=\"string\">'parsed'</span>,</span><br><span class=\"line\">                        <span class=\"comment\">//  在默认浏览器中自动打开报告</span></span><br><span class=\"line\">                        openAnalyzer: <span class=\"literal\">true</span>,</span><br><span class=\"line\">                        <span class=\"comment\">//  如果为true，则Webpack Stats JSON文件将在bundle输出目录中生成</span></span><br><span class=\"line\">                        generateStatsFile: <span class=\"literal\">false</span>,</span><br><span class=\"line\">                        <span class=\"comment\">//  如果`generateStatsFile`为`true`，将会生成Webpack Stats JSON文件的名字。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  相对于捆绑输出目录。</span></span><br><span class=\"line\">                        statsFilename: <span class=\"string\">'stats.json'</span>,</span><br><span class=\"line\">                        <span class=\"comment\">//  stats.toJson（）方法的选项。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  例如，您可以使用`source：false`选项排除统计文件中模块的来源。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  在这里查看更多选项：https：  //github.com/webpack/webpack/blob/webpack-1/lib/Stats.js#L21</span></span><br><span class=\"line\">                        statsOptions: <span class=\"literal\">null</span>,</span><br><span class=\"line\">                        logLevel: <span class=\"string\">'info'</span> <span class=\"comment\">//日志级别。可以是'信息'，'警告'，'错误'或'沉默'。</span></span><br><span class=\"line\">                    )</span><br><span class=\"line\">                ]</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 为开发环境修改配置...</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>默认在打包或者运行server时，接口8888为图像界面。</p>\n<h2 id=\"通过externals\"><a href=\"#通过externals\" class=\"headerlink\" title=\"通过externals\"></a>通过externals</h2><p>webpack文档<a href=\"https://webpack.docschina.org/configuration/externals\" target=\"_blank\" rel=\"noopener\">https://webpack.docschina.org/configuration/externals</a>有简单的介绍。<br>简单来说就是</p>\n<h3 id=\"1-添加cdn\"><a href=\"#1-添加cdn\" class=\"headerlink\" title=\"1.添加cdn\"></a>1.添加cdn</h3><p>在模板页面<code>index.html</code>中添加CDN链接，举例jQuery。<br><code>&lt;script src=&quot;https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js&quot;&gt;&lt;/script&gt;</code></p>\n<h3 id=\"2-设置externals\"><a href=\"#2-设置externals\" class=\"headerlink\" title=\"2.设置externals\"></a>2.设置externals</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// vue.config.js文件</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> BundleAnalyzerPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">'webpack-bundle-analyzer'</span>).BundleAnalyzerPlugin;</span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    configureWebpack: <span class=\"function\"><span class=\"params\">config</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (process.env.NODE_ENV === <span class=\"string\">'production'</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 为生产环境修改配置...</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">                plugins: [</span><br><span class=\"line\">                    <span class=\"keyword\">new</span> BundleAnalyzerPlugin()</span><br><span class=\"line\">                ],</span><br><span class=\"line\">                externals:&#123;</span><br><span class=\"line\">                    <span class=\"string\">'jquery'</span>: <span class=\"string\">'jQuery'</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 为开发环境修改配置...</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-关于开发时引用\"><a href=\"#3-关于开发时引用\" class=\"headerlink\" title=\"3.关于开发时引用\"></a>3.关于开发时引用</h3><p>可以通过下面代码引用，此时（上例设置为生产环境时）不会被webpack打包。同时可以引用使用。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> $ <span class=\"keyword\">from</span> <span class=\"string\">'jquery'</span>;</span><br></pre></td></tr></table></figure>\n<h2 id=\"通过splitChunks\"><a href=\"#通过splitChunks\" class=\"headerlink\" title=\"通过splitChunks\"></a>通过splitChunks</h2><p>上一种方式是通过cdn加速，这种是通过拆分Chunk的方式。<br>webpac中文文档地址<a href=\"https://webpack.docschina.org/plugins/split-chunks-plugin/\" target=\"_blank\" rel=\"noopener\">https://webpack.docschina.org/plugins/split-chunks-plugin/</a>，webpack4默认删除<code>CommonsChunkPlugin</code>。直接上代码</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// vue.config.js文件</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> BundleAnalyzerPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">'webpack-bundle-analyzer'</span>).BundleAnalyzerPlugin;</span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    configureWebpack: <span class=\"function\"><span class=\"params\">config</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (process.env.NODE_ENV === <span class=\"string\">'production'</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 为生产环境修改配置...</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">                optimization:&#123;</span><br><span class=\"line\">                    splitChunks:&#123;</span><br><span class=\"line\">                        cacheGroups: &#123;</span><br><span class=\"line\">                            libs: &#123;</span><br><span class=\"line\">                                name: <span class=\"string\">\"chunk-libs\"</span>,<span class=\"comment\">// 只打包初始时依赖的第三方</span></span><br><span class=\"line\">                                test: <span class=\"regexp\">/[\\\\/]node_modules[\\\\/]/</span>,</span><br><span class=\"line\">                                priority: <span class=\"number\">10</span>,</span><br><span class=\"line\">                                chunks: <span class=\"string\">\"initial\"</span></span><br><span class=\"line\">                            &#125;,</span><br><span class=\"line\">                            elementUI: &#123;</span><br><span class=\"line\">                                name: <span class=\"string\">\"chunk-elementUI\"</span>, <span class=\"comment\">// 单独将 elementUI 拆包</span></span><br><span class=\"line\">                                priority: <span class=\"number\">20</span>, <span class=\"comment\">// 权重要大于 libs 和 app 不然会被打包进 libs 或者 app</span></span><br><span class=\"line\">                                test: <span class=\"regexp\">/[\\\\/]node_modules[\\\\/]element-ui[\\\\/]/</span>,</span><br><span class=\"line\">                                chunks: <span class=\"string\">\"all\"</span></span><br><span class=\"line\">                            &#125;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    runtimeChunk: <span class=\"literal\">true</span></span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 为开发环境修改配置...</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>参考链接<br>vue-cli2参考<a href=\"https://blog.csdn.net/LY_never_cease/article/details/81333093\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/LY_never_cease/article/details/81333093</a></p>\n","more":"</p>\n<p>在vue-cli3不存在暴露的接口文件，需要通过<code>vue.config.js</code>配置来使用,展示的均为vue-cli3。vue-cli2类似，区别在于可在暴露的配置文件中直接添加。</p>\n<h2 id=\"webpack-bundle-analyzer\"><a href=\"#webpack-bundle-analyzer\" class=\"headerlink\" title=\"webpack-bundle-analyzer\"></a>webpack-bundle-analyzer</h2><p>用于显示打包之后的文件分析其大小.</p>\n<p>安装<code>npm install –save-dev webpack-bundle-analyzer</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// vue.config.js文件</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> BundleAnalyzerPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">'webpack-bundle-analyzer'</span>).BundleAnalyzerPlugin;</span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    <span class=\"comment\">// configureWebpack返回一个对象，会被 webpack-merge合并最终配置</span></span><br><span class=\"line\">    configureWebpack: <span class=\"function\"><span class=\"params\">config</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (process.env.NODE_ENV === <span class=\"string\">'production'</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 为生产环境修改配置...</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">                plugins: [</span><br><span class=\"line\">                    <span class=\"keyword\">new</span> BundleAnalyzerPlugin(</span><br><span class=\"line\">                        <span class=\"comment\">//  可以是`server`，`static`或`disabled`。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  在`server`模式下，分析器将启动HTTP服务器来显示软件包报告。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  在“静态”模式下，会生成带有报告的单个HTML文件。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  在`disabled`模式下，你可以使用这个插件来将`generateStatsFile`设置为`true`来生成Webpack Stats JSON文件。</span></span><br><span class=\"line\">                        analyzerMode: <span class=\"string\">'server'</span>,</span><br><span class=\"line\">                        <span class=\"comment\">//  将在“服务器”模式下使用的主机启动HTTP服务器。</span></span><br><span class=\"line\">                        analyzerHost: <span class=\"string\">'127.0.0.1'</span>,</span><br><span class=\"line\">                        <span class=\"comment\">//  将在“服务器”模式下使用的端口启动HTTP服务器。</span></span><br><span class=\"line\">                        analyzerPort: <span class=\"number\">8888</span>,</span><br><span class=\"line\">                        <span class=\"comment\">//  路径捆绑，将在`static`模式下生成的报告文件。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  相对于捆绑输出目录。</span></span><br><span class=\"line\">                        reportFilename: <span class=\"string\">'report.html'</span>,</span><br><span class=\"line\">                        <span class=\"comment\">//  模块大小默认显示在报告中。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  应该是`stat`，`parsed`或者`gzip`中的一个。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  有关更多信息，请参见“定义”一节。</span></span><br><span class=\"line\">                        defaultSizes: <span class=\"string\">'parsed'</span>,</span><br><span class=\"line\">                        <span class=\"comment\">//  在默认浏览器中自动打开报告</span></span><br><span class=\"line\">                        openAnalyzer: <span class=\"literal\">true</span>,</span><br><span class=\"line\">                        <span class=\"comment\">//  如果为true，则Webpack Stats JSON文件将在bundle输出目录中生成</span></span><br><span class=\"line\">                        generateStatsFile: <span class=\"literal\">false</span>,</span><br><span class=\"line\">                        <span class=\"comment\">//  如果`generateStatsFile`为`true`，将会生成Webpack Stats JSON文件的名字。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  相对于捆绑输出目录。</span></span><br><span class=\"line\">                        statsFilename: <span class=\"string\">'stats.json'</span>,</span><br><span class=\"line\">                        <span class=\"comment\">//  stats.toJson（）方法的选项。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  例如，您可以使用`source：false`选项排除统计文件中模块的来源。</span></span><br><span class=\"line\">                        <span class=\"comment\">//  在这里查看更多选项：https：  //github.com/webpack/webpack/blob/webpack-1/lib/Stats.js#L21</span></span><br><span class=\"line\">                        statsOptions: <span class=\"literal\">null</span>,</span><br><span class=\"line\">                        logLevel: <span class=\"string\">'info'</span> <span class=\"comment\">//日志级别。可以是'信息'，'警告'，'错误'或'沉默'。</span></span><br><span class=\"line\">                    )</span><br><span class=\"line\">                ]</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 为开发环境修改配置...</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>默认在打包或者运行server时，接口8888为图像界面。</p>\n<h2 id=\"通过externals\"><a href=\"#通过externals\" class=\"headerlink\" title=\"通过externals\"></a>通过externals</h2><p>webpack文档<a href=\"https://webpack.docschina.org/configuration/externals\" target=\"_blank\" rel=\"noopener\">https://webpack.docschina.org/configuration/externals</a>有简单的介绍。<br>简单来说就是</p>\n<h3 id=\"1-添加cdn\"><a href=\"#1-添加cdn\" class=\"headerlink\" title=\"1.添加cdn\"></a>1.添加cdn</h3><p>在模板页面<code>index.html</code>中添加CDN链接，举例jQuery。<br><code>&lt;script src=&quot;https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js&quot;&gt;&lt;/script&gt;</code></p>\n<h3 id=\"2-设置externals\"><a href=\"#2-设置externals\" class=\"headerlink\" title=\"2.设置externals\"></a>2.设置externals</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// vue.config.js文件</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> BundleAnalyzerPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">'webpack-bundle-analyzer'</span>).BundleAnalyzerPlugin;</span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    configureWebpack: <span class=\"function\"><span class=\"params\">config</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (process.env.NODE_ENV === <span class=\"string\">'production'</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 为生产环境修改配置...</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">                plugins: [</span><br><span class=\"line\">                    <span class=\"keyword\">new</span> BundleAnalyzerPlugin()</span><br><span class=\"line\">                ],</span><br><span class=\"line\">                externals:&#123;</span><br><span class=\"line\">                    <span class=\"string\">'jquery'</span>: <span class=\"string\">'jQuery'</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 为开发环境修改配置...</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-关于开发时引用\"><a href=\"#3-关于开发时引用\" class=\"headerlink\" title=\"3.关于开发时引用\"></a>3.关于开发时引用</h3><p>可以通过下面代码引用，此时（上例设置为生产环境时）不会被webpack打包。同时可以引用使用。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> $ <span class=\"keyword\">from</span> <span class=\"string\">'jquery'</span>;</span><br></pre></td></tr></table></figure>\n<h2 id=\"通过splitChunks\"><a href=\"#通过splitChunks\" class=\"headerlink\" title=\"通过splitChunks\"></a>通过splitChunks</h2><p>上一种方式是通过cdn加速，这种是通过拆分Chunk的方式。<br>webpac中文文档地址<a href=\"https://webpack.docschina.org/plugins/split-chunks-plugin/\" target=\"_blank\" rel=\"noopener\">https://webpack.docschina.org/plugins/split-chunks-plugin/</a>，webpack4默认删除<code>CommonsChunkPlugin</code>。直接上代码</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// vue.config.js文件</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> BundleAnalyzerPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">'webpack-bundle-analyzer'</span>).BundleAnalyzerPlugin;</span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    configureWebpack: <span class=\"function\"><span class=\"params\">config</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (process.env.NODE_ENV === <span class=\"string\">'production'</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 为生产环境修改配置...</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">                optimization:&#123;</span><br><span class=\"line\">                    splitChunks:&#123;</span><br><span class=\"line\">                        cacheGroups: &#123;</span><br><span class=\"line\">                            libs: &#123;</span><br><span class=\"line\">                                name: <span class=\"string\">\"chunk-libs\"</span>,<span class=\"comment\">// 只打包初始时依赖的第三方</span></span><br><span class=\"line\">                                test: <span class=\"regexp\">/[\\\\/]node_modules[\\\\/]/</span>,</span><br><span class=\"line\">                                priority: <span class=\"number\">10</span>,</span><br><span class=\"line\">                                chunks: <span class=\"string\">\"initial\"</span></span><br><span class=\"line\">                            &#125;,</span><br><span class=\"line\">                            elementUI: &#123;</span><br><span class=\"line\">                                name: <span class=\"string\">\"chunk-elementUI\"</span>, <span class=\"comment\">// 单独将 elementUI 拆包</span></span><br><span class=\"line\">                                priority: <span class=\"number\">20</span>, <span class=\"comment\">// 权重要大于 libs 和 app 不然会被打包进 libs 或者 app</span></span><br><span class=\"line\">                                test: <span class=\"regexp\">/[\\\\/]node_modules[\\\\/]element-ui[\\\\/]/</span>,</span><br><span class=\"line\">                                chunks: <span class=\"string\">\"all\"</span></span><br><span class=\"line\">                            &#125;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    runtimeChunk: <span class=\"literal\">true</span></span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 为开发环境修改配置...</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>参考链接<br>vue-cli2参考<a href=\"https://blog.csdn.net/LY_never_cease/article/details/81333093\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/LY_never_cease/article/details/81333093</a></p>","categories":[{"name":"工具","path":"api/categories/工具.json"}],"tags":[{"name":"脚手架","path":"api/tags/脚手架.json"},{"name":"webpack","path":"api/tags/webpack.json"},{"name":"vue","path":"api/tags/vue.json"}]}